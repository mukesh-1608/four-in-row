<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Connect 4 Backend Test</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        #log { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: scroll; background: #f0f0f0; }
        .controls { margin-bottom: 10px; }
    </style>
</head>
<body>
    <h1>Connect 4 WebSocket Test</h1>
    <div class="controls">
        <button onclick="connect()">Connect</button>
        <button onclick="sendMsg('join')">Send Join</button>
        <button onclick="sendMsg('move')">Send Move</button>
    </div>
    <div id="log"></div>

    <script>
        let ws;

        function log(msg) {
            const div = document.getElementById('log');
            div.innerHTML += `<div>${new Date().toLocaleTimeString()} - ${msg}</div>`;
            div.scrollTop = div.scrollHeight;
        }

        function connect() {
            if (ws) { log("Already connected"); return; }
            // Use relative path for WS
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsUrl = `${protocol}//${window.location.host}/ws`;
            
            ws = new WebSocket(wsUrl);
            
            ws.onopen = () => {
                log("Connected to " + wsUrl);
            };
            
            ws.onmessage = (event) => {
                log("Received: " + event.data);
            };
            
            ws.onclose = () => {
                log("Disconnected");
                ws = null;
            };
            
            ws.onerror = (err) => {
                log("Error: " + err);
            };
        }

        function sendMsg(type) {
            if (!ws) { log("Not connected"); return; }
            const msg = {
                type: type,
                payload: { test: "data" }
            };
            ws.send(JSON.stringify(msg));
            log("Sent: " + JSON.stringify(msg));
        }
    </script>
</body>
</html>
